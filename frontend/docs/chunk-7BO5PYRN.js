import{e as n}from"./chunk-UKOXNQ6D.js";import{a as s}from"./chunk-PP7TIRZV.js";import{M as a,P as c,U as o,j as i}from"./chunk-JKZU3RR7.js";var g=(()=>{class r{constructor(t,e){this.apiService=t,this.router=e,this.currentUserSubject=new i(null),this.currentUser$=this.currentUserSubject.asObservable(),this.loadUserFromStorage()}login(t){return this.apiService.post("auth/login",t).pipe(a(e=>{localStorage.setItem("token",e.token),localStorage.setItem("user",JSON.stringify(e)),this.currentUserSubject.next(e)}))}logout(){localStorage.removeItem("token"),localStorage.removeItem("user"),this.currentUserSubject.next(null),this.router.navigate(["/admin/login"])}isAuthenticated(){return!!localStorage.getItem("token")}getToken(){return localStorage.getItem("token")}getCurrentUser(){return this.currentUserSubject.value}loadUserFromStorage(){let t=localStorage.getItem("user");if(t)try{let e=JSON.parse(t);this.currentUserSubject.next(e)}catch{localStorage.removeItem("user"),localStorage.removeItem("token")}}static{this.\u0275fac=function(e){return new(e||r)(o(s),o(n))}}static{this.\u0275prov=c({token:r,factory:r.\u0275fac,providedIn:"root"})}}return r})();export{g as a};
