import{b as O,d as P,g as V,l as W,m as z,n as U,r as k}from"./chunk-DAGYDP6H.js";import{a as N}from"./chunk-XRCPTBJR.js";import{Ba as s,Ca as A,Gb as D,Ib as $,Qa as y,Sa as _,Va as n,Wa as i,Ya as M,Za as m,_ as T,_a as p,db as a,eb as c,ga as h,gb as C,ha as x,hb as v,ib as E,kb as I}from"./chunk-JKZU3RR7.js";function q(d,j){if(d&1){let e=M();n(0,"tr",13)(1,"td",16),a(2),i(),n(3,"td",16),a(4),i(),n(5,"td",16),a(6),i(),n(7,"td",16),a(8),i(),n(9,"td",16)(10,"select",17),m("change",function(o){let l=h(e).$implicit,r=p();return x(r.atualizarStatus(l.id,o))}),n(11,"option",18),a(12,"Pendente"),i(),n(13,"option",19),a(14,"Confirmado"),i(),n(15,"option",20),a(16,"Conclu\xEDdo"),i(),n(17,"option",21),a(18,"Cancelado"),i()()(),n(19,"td",16)(20,"button",22),m("click",function(){let o=h(e).$implicit,l=p();return x(l.excluir(o.id))}),a(21,"Excluir"),i()()()}if(d&2){let e=j.$implicit,t=p();s(2),c(e.clienteNome),s(2),c(e.clienteTelefone),s(2),c(e.servicoNome),s(2),c(t.formatarDataHora(e.dataHora)),s(2),_("value",e.status)}}var X=(()=>{class d{constructor(e){this.apiService=e,this.agendamentos=[],this.dataFiltro="",this.statusFiltro="";let t=new Date;this.dataFiltro=t.toISOString().split("T")[0]}ngOnInit(){this.carregarAgendamentos()}carregarAgendamentos(){let e={};if(this.dataFiltro){let t=new Date(this.dataFiltro);e.dataInicio=t.toISOString();let o=new Date(t);o.setDate(o.getDate()+1),e.dataFim=o.toISOString()}this.statusFiltro&&(e.status=parseInt(this.statusFiltro)),this.apiService.get("agendamentos",e).subscribe({next:t=>{this.agendamentos=t},error:t=>{console.error("Erro ao carregar agendamentos:",t)}})}atualizarStatus(e,t){let o=t.target.value,l={Pendente:1,Confirmado:2,Concluido:3,Cancelado:4};this.apiService.get(`agendamentos/${e}`).subscribe({next:r=>{let g={clienteNome:r.clienteNome,clienteTelefone:r.clienteTelefone,clienteEmail:r.clienteEmail,servicoId:r.servicoId,dataHora:r.dataHora,status:l[o],observacoes:r.observacoes};this.apiService.put(`agendamentos/${e}`,g).subscribe({next:()=>{this.carregarAgendamentos()},error:S=>{console.error("Erro ao atualizar status:",S),alert("Erro ao atualizar status")}})}})}excluir(e){confirm("Tem certeza que deseja excluir este agendamento?")&&this.apiService.delete(`agendamentos/${e}`).subscribe({next:()=>{this.carregarAgendamentos()},error:t=>{console.error("Erro ao excluir agendamento:",t),alert("Erro ao excluir agendamento")}})}formatarDataHora(e){if(!e)return"";try{if(e.match(/^\d{1,2}\/\d{1,2}\/\d{4}/)){let u=e.split(/\s*\//);if(u.length>=3){let B=parseInt(u[0]),H=parseInt(u[1]),f=u[2].split(/\s+/),L=parseInt(f[0]),b=0,w=0;if(f.length>1){let F=f[1].split(":");b=parseInt(F[0])||0,w=parseInt(F[1])||0}return`${H.toString().padStart(2,"0")}/${B.toString().padStart(2,"0")}/${L} ${b.toString().padStart(2,"0")}:${w.toString().padStart(2,"0")}`}}let t=new Date(e);if(isNaN(t.getTime()))return e;let o=t.getUTCDate().toString().padStart(2,"0"),l=(t.getUTCMonth()+1).toString().padStart(2,"0"),r=t.getUTCFullYear(),g=t.getUTCHours().toString().padStart(2,"0"),S=t.getUTCMinutes().toString().padStart(2,"0");return`${o}/${l}/${r} ${g}:${S}`}catch{return e}}static{this.\u0275fac=function(t){return new(t||d)(A(N))}}static{this.\u0275cmp=T({type:d,selectors:[["app-agendamentos"]],standalone:!0,features:[I],decls:35,vars:3,consts:[[1,"space-y-4","sm:space-y-6"],[1,"text-2xl","sm:text-3xl","font-bold","text-primary","dark:text-white"],[1,"card","overflow-hidden"],[1,"mb-4","flex","flex-col","sm:flex-row","gap-2","sm:gap-4"],["type","date",1,"p-2","border","rounded-lg","flex-1",3,"ngModelChange","change","ngModel"],[1,"p-2","border","rounded-lg","flex-1","sm:flex-initial","sm:w-auto",3,"ngModelChange","change","ngModel"],["value",""],["value","1"],["value","2"],["value","3"],["value","4"],[1,"overflow-x-auto"],[1,"w-full","min-w-[800px]"],[1,"border-b"],[1,"text-left","p-2"],["class","border-b",4,"ngFor","ngForOf"],[1,"p-2"],[1,"p-1","border","rounded",3,"change","value"],["value","Pendente"],["value","Confirmado"],["value","Concluido"],["value","Cancelado"],[1,"text-red-600",3,"click"]],template:function(t,o){t&1&&(n(0,"div",0)(1,"h1",1),a(2,"Agendamentos"),i(),n(3,"div",2)(4,"div",3)(5,"input",4),E("ngModelChange",function(r){return v(o.dataFiltro,r)||(o.dataFiltro=r),r}),m("change",function(){return o.carregarAgendamentos()}),i(),n(6,"select",5),E("ngModelChange",function(r){return v(o.statusFiltro,r)||(o.statusFiltro=r),r}),m("change",function(){return o.carregarAgendamentos()}),n(7,"option",6),a(8,"Todos os Status"),i(),n(9,"option",7),a(10,"Pendente"),i(),n(11,"option",8),a(12,"Confirmado"),i(),n(13,"option",9),a(14,"Conclu\xEDdo"),i(),n(15,"option",10),a(16,"Cancelado"),i()()(),n(17,"div",11)(18,"table",12)(19,"thead")(20,"tr",13)(21,"th",14),a(22,"Cliente"),i(),n(23,"th",14),a(24,"Telefone"),i(),n(25,"th",14),a(26,"Servi\xE7o"),i(),n(27,"th",14),a(28,"Data/Hora"),i(),n(29,"th",14),a(30,"Status"),i(),n(31,"th",14),a(32,"A\xE7\xF5es"),i()()(),n(33,"tbody"),y(34,q,22,5,"tr",15),i()()()()()),t&2&&(s(5),C("ngModel",o.dataFiltro),s(),C("ngModel",o.statusFiltro),s(28),_("ngForOf",o.agendamentos))},dependencies:[$,D,k,z,U,O,W,P,V],encapsulation:2})}}return d})();export{X as AgendamentosComponent};
